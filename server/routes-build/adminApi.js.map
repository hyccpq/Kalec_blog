{"version":3,"sources":["../routes/adminApi.js"],"names":["controller","get","put","del","post","required","auth","admin","fileUpload","checkPassword","commitArticle","editArticle","deleteArticle","editShow","getAdArticleList","getOneAdArticle","delMark","delReply","searchOneArticleComment","addTagOrClassicInfo","saveReply","saveMark","searchOneArticle","resData","getToken","AdminApiControllers","body","login","ctx","next","user","password","request","ip","matchData","match","session","views","_id","userInfo","email","role","token","e","toString","addArticle","addInfo","data","editInfo","id","searchAll","params","query","parseInt","page","count","searchAdArticle","editArticleShow","show","deleteMyArticle","upload","fileName","req","file","filename","filePath","searchOne","result","addMark","content","console","log","markData","isManage","addReply","markId","replyUser","replyData","deleteReply","replyId","deleteMark","addTagOrClassic"],"mappings":"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","sourcesContent":["import {\n  controller,\n  get,\n  put,\n  del,\n  post,\n  required,\n  auth,\n  admin,\n  fileUpload\n} from '../lib/decorator.js'\n\nimport {\n  checkPassword,\n  commitArticle,\n  editArticle,\n  deleteArticle,\n  editShow,\n  getAdArticleList,\n  getOneAdArticle,\n  delMark,\n  delReply,\n  searchOneArticleComment,\n  addTagOrClassicInfo\n} from '../service/getAdminInfo.js'\nimport {\n  saveReply,\n  saveMark,\n  searchOneArticle\n} from '../service/getArticleInfo.js'\nimport { resData } from '../lib/util.js'\nimport { getToken } from '../service/auth.js'\n\n@controller('/api/admin/v0')\nexport default class AdminApiControllers {\n  static isManage = true\n\n  @post('/login')\n  @required({\n    body: ['user', 'password']\n  })\n  async login(ctx, next) {\n    const { user, password } = ctx.request.body\n    let ip = ctx.request.ip\n    try {\n      const matchData = await checkPassword(user, password, ip)\n\n      if (matchData.match) {\n        ctx.session.views = {\n          _id: matchData.userInfo._id,\n          email: matchData.userInfo.email,\n          role: matchData.userInfo.role,\n          user: matchData.userInfo.user\n        }\n\n        let token = getToken(user)\n\n        ctx.body = resData(1, '登录成功', token)\n      } else {\n        ctx.body = resData(2, '用户名或密码错误')\n      }\n    } catch (e) {\n      ctx.body = resData(0, '出现错误', e.toString())\n    }\n  }\n\n  @post('/addArticle')\n  @auth\n  @admin('admin')\n  async addArticle(ctx, next) {\n    try {\n      const addInfo = ctx.request.body\n      let data = await commitArticle(addInfo)\n      ctx.body = resData(1, '查询成功', data)\n    } catch (e) {\n      ctx.body = resData(0, '出现错误', e.toString())\n    }\n  }\n\n  @put('/editArticle')\n  @auth\n  @admin('admin')\n  async editArticle(ctx, next) {\n    try {\n      const editInfo = ctx.request.body\n      let data = await editArticle(editInfo.id, editInfo)\n      ctx.body = resData(1, '查询成功', data)\n    } catch (e) {\n      ctx.body = resData(0, '出现错误', e.toString())\n    }\n  }\n\n  @get('/searchAll')\n  @auth\n  async searchAll(ctx, next) {\n    try {\n      const params = ctx.request.query\n      let data = await getAdArticleList(\n        parseInt(params.page),\n        parseInt(params.count),\n        params\n      )\n      ctx.body = resData(1, '查询成功', data)\n    } catch (e) {\n      ctx.body = resData(0, '出现错误', e.toString())\n    }\n  }\n\n  @get('/searchAdArticle')\n  @auth\n  @admin('admin')\n  async searchAdArticle(ctx, next) {\n    try {\n      const { id } = ctx.request.query\n      let data = await getOneAdArticle(id)\n      ctx.body = resData(1, '查询成功', data)\n    } catch (e) {\n      ctx.body = resData(0, '出现错误', e.toString())\n    }\n  }\n\n  @put('/editShow')\n  @auth\n  @admin('admin')\n  async editArticleShow(ctx, next) {\n    try {\n      const { id, show } = ctx.request.body\n      let data = await editShow(id, show)\n      ctx.body = resData(1, '查询成功', data)\n    } catch (e) {\n      ctx.body = resData(0, '出现错误', e.toString())\n    }\n  }\n\n  @del('/deleteArticle')\n  @auth\n  @admin('admin')\n  async deleteMyArticle(ctx, next) {\n    try {\n      const { id } = ctx.request.query\n\n      let data = await deleteArticle(id)\n      ctx.body = resData(1, '查询成功', { data })\n    } catch (e) {\n      ctx.body = resData(0, '出现错误', e.toString())\n    }\n  }\n\n  @post('/upload')\n  @admin('admin')\n  @fileUpload('articleImage')\n  async upload(ctx, next) {\n    try {\n      let fileName = ctx.req.file.filename\n\n      ctx.body = resData(1, '上传成功', {\n        fileName,\n        filePath: `uploads/${fileName}`\n      })\n    } catch (e) {\n      ctx.body = resData(0, '出现错误', e.toString())\n    }\n  }\n\n  @get('/searchOneComment')\n  async searchOne(ctx, next) {\n    let { id } = ctx.request.query\n    try {\n      let result = await searchOneArticleComment(id)\n      ctx.body = resData(1, '查询成功', result)\n    } catch (e) {\n      ctx.body = resData(0, '查询出错')\n      throw e\n    }\n  }\n\n  @post('/addAdMark')\n  @auth\n  @admin('admin')\n  async addMark(ctx, next) {\n    let { _id, user, email, content } = ctx.request.body\n    console.log(ctx.request.body)\n    try {\n      if (_id && user && email && content) {\n        let markData = await saveMark(\n          _id,\n          user,\n          email,\n          content,\n          AdminApiControllers.isManage\n        )\n\n        ctx.body = resData(1, '查询成功', markData)\n      } else {\n        throw '信息不全'\n      }\n    } catch (e) {\n      ctx.body = resData(0, '查询出错', e.toString())\n      throw e\n    }\n  }\n\n  @post('/addAdReply')\n  @auth\n  @admin('admin')\n  async addReply(ctx, next) {\n    let { _id, markId, user, replyUser, email, content } = ctx.request.body\n    try {\n      if (_id && markId && user && email && content) {\n        let replyData = await saveReply(\n          _id,\n          markId,\n          user,\n          replyUser,\n          email,\n          content,\n          AdminApiControllers.isManage\n        )\n        ctx.body = resData(1, '查询成功', replyData)\n      } else {\n        throw '信息不全'\n      }\n    } catch (e) {\n      ctx.body = resData(0, '查询出错', e.toString())\n      throw e\n    }\n  }\n\n  @del('/deleteReply')\n  @auth\n  @admin('admin')\n  async deleteReply(ctx, next) {\n    let { id, markId, replyId } = ctx.request.query\n    try {\n      await delReply(id, markId, replyId)\n      ctx.body = resData(1, '删除成功', {})\n    } catch (e) {\n      ctx.body = resData(0, '出现错误', e.toString())\n    }\n  }\n\n  @del('/deleteMark')\n  @auth\n  @admin('admin')\n  async deleteMark(ctx, next) {\n    let { id, markId } = ctx.request.query\n    try {\n      await delMark(id, markId)\n      ctx.body = resData(1, '删除成功', {})\n    } catch (e) {\n      ctx.body = resData(0, '出现错误', e.toString())\n    }\n  }\n\n  @post('/addTagOrClassic')\n  @auth\n  @admin('admin')\n  async addTagOrClassic(ctx, next) {\n    let params = ctx.request.body\n    try {\n      let data = await addTagOrClassicInfo(params)\n      ctx.body = resData(1, '查询成功', data)\n    } catch (e) {\n      ctx.body = resData(0, '出现错误', e.toString())\n    }\n  }\n}\n"],"file":"adminApi.js"}